[config]

# Documentation for this use-case can be found at:
# https://metplus.readthedocs.io/en/latest/generated/model_applications/short_range/MODEMultivar_fcstRRFS_obsGOES_MRMS_BrightnessTemp_Lightning.html

# Processes to run
PROCESS_LIST = MODE

# Time Info
LOOP_BY = INIT
INIT_TIME_FMT = %Y%m%d%H
INIT_BEG=2024010905
INIT_END=2024010905
INIT_INCREMENT = 1H

LEAD_SEQ = 9,10

MODEL = RRFS
OBTYPE = ANALYSIS

##################################
# Multivariate MODE Configurations
##################################

# Run MODE to output super objects
MODE_MULTIVAR_LOGIC = #1 && #2 || #3
MODE_MULTIVAR_INTENSITY_FLAG = FALSE,TRUE,TRUE

FCST_MODE_INPUT_DIR = {INPUT_BASE}/model_applications/short_range/MODEMultivar_fcstRRFS_obsGOES_MRMS_BrightnessTemp_Lightning
FCST_MODE_INPUT_TEMPLATE= {init?fmt=%Y%m%d}.{init?fmt=%H}00.F{lead?fmt=%HH}00.nc,{init?fmt=%Y%m%d}.{init?fmt=%H}00.F{lead?fmt=%HH}00.nc,{init?fmt=%Y%m%d}.{init?fmt=%H}00.F{lead?fmt=%HH}00.nc

OBS_MODE_INPUT_DIR = {INPUT_BASE}/model_applications/short_range/MODEMultivar_fcstRRFS_obsGOES_MRMS_BrightnessTemp_Lightning
OBS_MODE_INPUT_TEMPLATE = remap_GOES-16.{valid?fmt=%Y%m%d}.{valid?fmt=%H}0000.nc,{valid?fmt=%Y%m%d}-{valid?fmt=%H}0000_remap.nc,remap_GOES-16_lightning_{valid?fmt=%Y%m%d}-{valid?fmt=%H}00_75W.nc

MODE_OUTPUT_DIR = {OUTPUT_BASE}/model_applications/short_range/MODEMultivar_fcstRRFS_obsGOES_MRMS_BrightnessTemp_Lightning
MODE_OUTPUT_TEMPLATE = f{lead?fmt=%2H}

FCST_MODE_FILE_WINDOW_BEGIN = 0
FCST_MODE_FILE_WINDOW_END = 0

OBS_MODE_FILE_WINDOW_BEGIN = 0
OBS_MODE_FILE_WINDOW_END = 0

###
# Field Info
###


FCST_VAR1_NAME = bt13_topofatmosphere_G16
FCST_VAR1_LEVELS = (*,*)
FCST_VAR1_OPTIONS = conv_radius = 5; conv_thresh = <=230; merge_thresh = <=230; merge_flag = NONE; file_type = NETCDF_MET; filter_attr_name = ["AREA"]; filter_attr_thresh= [ >=1 ]; censor_thresh = [<=0]; censor_val = [9999]; vld_thresh = 0.5; inten_perc_value  = 100; inten_perc_thresh = NA


OBS_VAR1_NAME = channel_13_brightness_temperature
OBS_VAR1_LEVELS = L0
OBS_VAR1_OPTIONS = conv_radius = 0; conv_thresh = <=230; merge_thresh = <=230; merge_flag = NONE; file_type = NETCDF_MET; filter_attr_name = ["AREA"]; filter_attr_thresh= [ >=1 ]; censor_thresh = [<=0]; censor_val = [9999]; vld_thresh = 0.5; inten_perc_value  = 100; inten_perc_thresh = NA


FCST_VAR2_NAME = REFC_entireatmosphere_consideredasinglelayer
FCST_VAR2_LEVELS = (*,*)
FCST_VAR2_OPTIONS = conv_radius = 5; conv_thresh = >=40; merge_thresh = >=40; merge_flag = NONE; file_type = NETCDF_MET; filter_attr_name = ["AREA"]; filter_attr_thresh= [ >=1 ]; censor_thresh = [< -30]; censor_val = [9999]; vld_thresh = 0.5; inten_perc_value  = 100; inten_perc_thresh = NA

OBS_VAR2_NAME = MergedReflectivityQCComposite
OBS_VAR2_LEVELS = (*,*)
OBS_VAR2_OPTIONS = conv_radius = 5; conv_thresh = >=40; merge_thresh = >=40; merge_flag = NONE; file_type = NETCDF_MET; filter_attr_name = ["AREA"]; filter_attr_thresh= [ >=1 ]; censor_thresh = [< -30]; censor_val = [9999]; vld_thresh = 0.5; inten_perc_value  = 100; inten_perc_thresh = NA


FCST_VAR3_NAME = LTNG_entireatmosphere
FCST_VAR3_LEVELS = (*,*)
FCST_VAR3_OPTIONS = conv_radius = 3; conv_thresh = >SFP10; merge_thresh = >SFP10; merge_flag = THRESH; file_type = NETCDF_MET; censor_thresh = [<= 0]; censor_val = [-9999]; vld_thresh = 0.5; inten_perc_value  = 100; inten_perc_thresh = NA

OBS_VAR3_NAME = flash_extent_density
OBS_VAR3_LEVELS = (*,*)
OBS_VAR3_OPTIONS = conv_radius = 3; conv_thresh = >SOP10; merge_thresh = >SOP10; merge_flag = THRESH; file_type = NETCDF_MET; censor_thresh = [<= 0]; censor_val = [-9999]; vld_thresh = 0.5; inten_perc_value  = 100; inten_perc_thresh = NA


MODE_MATCH_FLAG = MERGE_BOTH

MODE_REGRID_TO_GRID = NONE

LOG_MODE_VERBOSITY = 4

MODE_OUTPUT_PREFIX = {MODEL}_or_{OBTYPE}

MODE_GRID_RES = 3

MODE_INTEREST_FUNCTION_CENTROID_DIST = ((            0.0, 1.0 )(  60.0/grid_res, 1.0 )( 450.0/grid_res, 0.0 ))
MODE_INTEREST_FUNCTION_BOUNDARY_DIST = ((            0.0, 1.0 )( 400.0/grid_res, 0.0 ))
MODE_INTEREST_FUNCTION_CONVEX_HULL_DIST = ((            0.0, 1.0 )( 400.0/grid_res, 0.0 ))
MODE_INTEREST_FUNCTION_ANGLE_DIFF = ((  0.0, 1.0 )( 30.0, 1.0 )( 90.0, 0.0 ))
MODE_INTEREST_FUNCTION_ASPECT_DIFF = ((  0.00, 1.0 )(  0.10, 1.0 )(  0.75, 0.0 ))
MODE_INTEREST_FUNCTION_AREA_RATIO = ((    0.0, 0.0 )(    0.8, 1.0 )(    1.0, 1.0 ))
MODE_INTEREST_FUNCTION_INT_AREA_RATIO = (( 0.00, 0.00 )( 0.10, 0.50 )( 0.25, 1.00 )( 1.00, 1.00 ))
MODE_INTEREST_FUNCTION_CURVATURE_RATIO = ((    0.0, 0.0 )(    0.8, 1.0 )(    1.0, 1.0 ))
MODE_INTEREST_FUNCTION_COMPLEXITY_RATIO = ((    0.0, 0.0 )(    0.8, 1.0 )(    1.0, 1.0 ))
MODE_INTEREST_FUNCTION_INTEN_PERC_RATIO = ((    0.0, 0.0 )(    0.8, 1.0 )(    1.0, 1.0 ))

MODE_TOTAL_INTEREST_THRESH = 0.65

MODE_MASK_GRID = ""
MODE_MASK_GRID_FLAG = NONE
MODE_MASK_POLY = ""
MODE_MASK_POLY_FLAG = NONE

MODE_MASK_MISSING_FLAG = BOTH
MODE_MATCH_FLAG = MERGE_BOTH

MODE_MAX_CENTROID_DIST = 600.0/grid_res

MODE_WEIGHT_CENTROID_DIST = 4.0
MODE_WEIGHT_BOUNDARY_DIST = 3.0
MODE_WEIGHT_CONVEX_HULL_DIST = 1.0 
MODE_WEIGHT_ANGLE_DIFF = 1.0
MODE_WEIGHT_ASPECT_DIFF = 0.0
MODE_WEIGHT_AREA_RATIO = 4.0
MODE_WEIGHT_INT_AREA_RATIO = 3.0
MODE_WEIGHT_CURVATURE_RATIO = 0.0
MODE_WEIGHT_COMPLEXITY_RATIO = 0.0
MODE_WEIGHT_INTEN_PERC_RATIO = 0.0
MODE_WEIGHT_INTEN_PERC_VALUE = 50

MODE_NC_PAIRS_FLAG_LATLON = TRUE
MODE_NC_PAIRS_FLAG_RAW = TRUE
MODE_NC_PAIRS_FLAG_OBJECT_RAW = TRUE
MODE_NC_PAIRS_FLAG_OBJECT_ID = TRUE
MODE_NC_PAIRS_FLAG_CLUSTER_ID = TRUE
MODE_NC_PAIRS_FLAG_POLYLINES = TRUE

MODE_QUILT = False

MODE_PS_PLOT_FLAG = TRUE
MODE_CT_STATS_FLAG = TRUE
